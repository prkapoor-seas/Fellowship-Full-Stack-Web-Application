<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Apply for {{ fellowship.get_fellowship_name() }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <style>
        body { font-family: Arial, sans-serif;  }
        label { display: block; margin-top: 10px; font-weight: bold; }
        textarea { width: 100%; padding: 8px; margin-top: 5px; }
        button { margin-top: 15px; padding: 10px 20px; font-size: 16px; }
    </style>
</head>
<body>
    <header class="topbar">
      <div class="inner_topbar">
        <div class="logo">
          <a class="logotext" href="{{ url_for('index') }}"> LabsAtYale </a>
        </div>
        <nav class="navigationBar">
          <a href="{{ url_for('fellowships') }}" class="{% if request.path == '/fellowships' %}active{% endif %}">Fellowships</a>
          <a href="{{ url_for('labs') }}" class="{% if request.path == '/labs' %}active{% endif %}">Labs</a>
          <a href="{{ url_for('faculty') }}" class="{% if request.path == '/faculty' %}active{% endif %}">Faculty</a>

          {% if current_user.role == 'faculty' %}
            <a href="{{ url_for('add_fellowship') }}">Add a Fellowship</a>
          {% endif %}
              {% if current_user.role == 'student' %}
            <a href="{{ url_for('applications') }}" class="{% if request.path == '/applications' %}active{% endif %}">Applications</a>
          {% endif %}

          {% if current_user.is_authenticated %}

            <a href="{{ url_for('profile') }}" class="{% if request.path == '/profile' %}active{% endif %}">Profile</a>
            <a href="{{ url_for('logout') }}">Logout</a>
          {% else %}
            <a href="{{ url_for('login') }}">Login</a>
          {% endif %}
        </nav>
      </div>
    </header>

    <h2>Apply for {{ fellowship.get_fellowship_name() }}</h2>
    <p><strong>Lab:</strong> {{ fellowship.get_lab_name() }} | <strong>Faculty:</strong> {{ fellowship.get_faculty_name() }}</p>
    <p><strong>Deadline:</strong> {{ fellowship.get_deadline() }}</p>

    <form id="resume-form" enctype="multipart/form-data" method="POST" action="{{ url_for('upload_resume_application', fellowship_id=fellowship.get_fellowship_id()) }}" style="margin-top: 20px;">
        {% if resume_info %}

            <div class="form-row">
                <label>Resume:</label>
                <div style="display: flex; gap: 15px; align-items: center; width: 60%;">
                  <span>{{ resume_info.filename }}</span>
                  <a href="{{ url_for('download_resume') }}" class="btn-primary" style="display: inline-block; padding: 8px 14px; background-color: #1976d2; color: white; text-decoration: none; border-radius: 10px; font-size: 14px;">
                    Download
                  </a>
                </div>
              </div>

            <div class="form-row" style="margin-top: 15px;">
                <label>Replace Resume:</label>
                <div style="display: flex; gap: 10px; align-items: center; width: 60%;">
                  <input
                    type="file"
                    id="resume-input"
                    name="resume"
                    accept=".pdf"
                    required
                    style="width: 300px;"
                  />
                  <button type="submit" class="btn-primary" style="padding: 8px 14px; background-color: #546e7a; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 500; font-size: 14px;">
                    Upload
                  </button>
                </div>
              </div>

            <div style="margin-top: 20px;">
            <iframe
                src="{{ url_for('view_resume') }}"
                width="100%"
                height="600px"
                style="border: 1px solid #ccc; border-radius: 8px;">
            </iframe>
            </div>

        {% else %}

        <div class="form-row">
            <label>Resume:</label>
            <div style="display: flex; gap: 10px; align-items: center; width: 60%;">
              <input
                type="file"
                id="resume-input"
                name="resume"
                accept=".pdf"
                required
                style="width: 300px;"
              />
              <button type="submit" class="btn-primary" style="padding: 8px 14px; background-color: #1976d2; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 500; font-size: 14px;">
                Upload
              </button>
            </div>
          </div>
        {% endif %}
      </form>

    <form method="POST">
        <label for="questions">Personal Statement (optional):</label>
        <textarea id="questions" name="questions" rows="5"></textarea>

        {% if resume_info %}
        <button type="submit">Submit Application</button>
        {% else %}
        <p> Upload a Resume to Submit Application </p>
        {% endif %}
    </form>
</body>
</html>
